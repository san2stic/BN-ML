environment: live
base_quote: USDC

exchange:
  name: binance
  testnet: false
  rate_limit_ms: 200
  timeout_ms: 10000
  retry_attempts: 3
  retry_backoff_sec: 0.5

data:
  paper_market_data_mode: live

universe:
  user_selected_only: false
  user_selected_pairs: []
  dynamic_base_quote_pairs: true
  dynamic_refresh_sec: 900
  pairs:
    - BTC/USDC
    - ETH/USDC
    - SOL/USDC
    - BNB/USDC
    - XRP/USDC
    - ADA/USDC
    - DOGE/USDC
  min_24h_volume_usdt: 1000000
  max_pairs_scanned: 150
  train_dynamic_pairs: true
  train_max_pairs: 120
  train_missing_only: true
  model_max_age_hours: 24

scanner:
  scan_interval_sec: 300
  top_n: 10
  ohlcv_limit: 500
  min_global_score: 60
  min_ml_confidence: 65
  spread_max_pct: 0.15
  orderbook_depth_min_usdt: 50000
  dynamic_pair_filters:
    enabled: true
    major_bases: [BTC, ETH, BNB, SOL, XRP, ADA, DOGE]
    spread_factor_major: 1.10
    spread_factor_alt: 0.95
    depth_factor_major: 0.90
    depth_factor_alt: 1.10
    correlation_bonus_major: 0.05
    correlation_penalty_alt: -0.05
    correlation_limit_benchmark: 1.0
    by_symbol: {}

model:
  lookback_days: 60
  training_window_days: 45
  retrain_interval_hours: 6
  retrain_check_interval_sec: 30
  retrain_degradation_trigger_pct: 15
  auto_retrain_enabled: true
  auto_train_missing_models: true
  auto_train_missing_batch_size: 5
  auto_train_missing_disable_hpo: false
  feature_limit: 50
  sequence_length: 64
  random_state: 42
  train_ohlcv_limit: 5000
  backtest_ohlcv_limit: 3000
  multi_timeframe:
    enabled: true
    base_timeframe: 15m
    timeframes: [1h, 4h, 1d]
    feature_columns:
      - ema_9
      - ema_21
      - ema_50
      - macd_hist
      - rsi_14
      - atr_ratio
      - bb_percent_b
      - volume_ratio_20
      - roc_1h
      - roc_4h
      - dist_high_24h
      - dist_low_24h
      - adx_14
      - stoch_k
      - cci_20
      - keltner_pct
      - vol_regime_ratio
      - supertrend_direction
    min_candles_per_timeframe: 200
    max_candles_per_timeframe: 600
    extra_candles_buffer: 96
  acceleration:
    mode: cuda
    cpu_n_jobs: -1
    allow_cuda_fallback: true
  execution:
    cost_multiplier: 1.0
  hpo:
    enabled: true
    backend: optuna
    max_samples: 2000
    max_splits: 4
    rf_trials: 20
    xgb_trials: 15
    lgb_trials: 15
    objective_weight_sharpe: 0.35
    objective_weight_sortino: 0.30
    objective_weight_accuracy: 0.10
    objective_weight_return: 0.25
    objective_weight_drawdown: 0.10
    objective_weight_turnover: 0.05
  labeling:
    horizon_candles: 4
    volatility_window: 96
    volatility_multiplier: 0.60
    atr_multiplier: 0.35
    min_move_pct: 0.0015
    max_move_pct: 0.0200
    round_trip_cost_multiplier: 2.0
    cost_safety_multiplier: 1.35
  ensemble:
    calibration: isotonic
    min_buy_proba: 0.42
    min_sell_proba: 0.42
    min_margin: 0.07
    hold_bias: 0.02
  rf:
    n_estimators: 300
    max_depth: 8
    min_samples_leaf: 50
  xgb:
    n_estimators: 500
    max_depth: 6
    learning_rate: 0.03
    subsample: 0.9
    colsample_bytree: 0.8
    reg_alpha: 0.01
    reg_lambda: 1.0
    early_stopping_rounds: 40
  lgb:
    enabled: true
    n_estimators: 400
    max_depth: -1
    num_leaves: 31
    learning_rate: 0.03
    subsample: 0.8
    colsample_bytree: 0.8
    reg_alpha: 0.01
    reg_lambda: 1.0
    min_child_samples: 30
  lstm:
    enabled: false
    sequence_length: 64
    hidden_size: 128
    hidden_size_2: 64
    epochs: 30
    batch_size: 64
    dropout: 0.25
    alpha: 0.0001
  drift:
    enabled: true
    baseline_window: 240
    recent_window: 64
    ks_threshold: 0.24
    p_value_threshold: 0.05
    vol_ratio_threshold: 1.8
  santrade_intelligence:
    enabled: true
    profile: defensive
    benchmark_symbol: ""
    online_alpha: 0.0005
    persist_every_updates: 5
    state_path: artifacts/state/santrade_intelligence.joblib
    profiles:
      aggressive:
        min_pairs: 6
        bullish_threshold: 0.14
        bearish_threshold: -0.14
        atr_risk_off_ratio: 0.026
        spread_risk_off_pct: 0.30
        min_directional_confidence: 58
        min_directional_streak: 1
      neutral:
        min_pairs: 8
        bullish_threshold: 0.22
        bearish_threshold: -0.22
        atr_risk_off_ratio: 0.018
        spread_risk_off_pct: 0.18
        min_directional_confidence: 68
        min_directional_streak: 2
      defensive:
        min_pairs: 12
        bullish_threshold: 0.30
        bearish_threshold: -0.28
        atr_risk_off_ratio: 0.014
        spread_risk_off_pct: 0.12
        min_directional_confidence: 78
        min_directional_streak: 2

model_sync:
  enabled: false
  repo_dir: ""
  remote: origin
  branch: main
  repo_models_subdir: models
  publisher:
    schedule: "00:00"
    train_before_push: true
  client:
    schedule: "06:00"
  runpod_client:
    schedule: "03:00"
  runpod:
    enabled: true
    trigger_url: "https://api.runpod.ai/v2/dzopl5dit7s70g/run"
    status_url_template: "https://api.runpod.ai/v2/dzopl5dit7s70g/status/{job_id}"
    api_key_env: RUNPOD_API_KEY
    trigger_method: POST
    trigger_payload:
      input:
        prompt: "Train BN-ML models only (no trading bot execution) and return a downloadable models archive"
    headers: {}
    request_timeout_sec: 20
    poll_interval_sec: 10
    job_timeout_sec: 3600
    download_timeout_sec: 300
    extract_subdir: models

risk:
  capital_total: auto
  capital_total_fallback: 20
  capital_active_ratio: 0.60
  reserve_ratio: 0.30
  cash_buffer_ratio: 0.10
  max_positions: 5
  min_position_pct_active: 0.01
  max_position_pct_active: 0.20
  max_daily_risk_pct: 0.02
  max_weekly_risk_pct: 0.06
  max_portfolio_exposure_pct: 0.70
  max_position_drawdown_pct: 0.03
  max_correlation: 0.70
  stop_loss_atr_mult: 1.5
  atr_ohlcv_limit: 150
  trailing_activation_pct: 0.02
  trailing_atr_mult: 1.0
  time_stop_hours: 48
  fees_pct: 0.10
  slippage_pct: 0.05
  min_net_profit_pct: 0.30
  circuit_breakers:
    daily_drawdown_stop_pct: -5.0
    max_consecutive_losses: 3
    volatility_spike_ratio: 1.5
    drift_block_enabled: true
    market_intelligence_block_enabled: true
    market_intelligence_min_confidence: 72
    market_intelligence_min_confidence_by_profile:
      aggressive: 64
      neutral: 70
      defensive: 78
    market_intelligence_block_on_risk_off: true
    market_intelligence_score_block_threshold: null
  drift_benchmark_symbol: ""

monitoring:
  log_level: INFO
  logs_dir: artifacts/logs
  metrics_dir: artifacts/metrics
  alerts_enabled: true
  realtime_prices:
    enabled: true
    include_scan_pairs: true
    max_symbols: 30
    reconnect_delay_sec: 3.0
  alerting:
    timeout_sec: 4.0
    dedupe_sec: 30
    webhook_url: ""
    telegram_bot_token: ""
    telegram_chat_id: ""
    email:
      smtp_host: ""
      smtp_port: 587
      smtp_username: ""
      smtp_password: ""
      from: ""
      to: []
      use_tls: true
      subject_prefix: "[BN-ML ALERT]"
  dashboard:
    auto_launch_with_bot: true
    script: monitoring/dashboard.py
    address: 127.0.0.1
    port: 8501
    auto_refresh_sec: 5
    full_screen_default: true
    timeframe_default: 4h
    live_market_enabled: true
    scan_stale_sec: 900

public_api:
  enabled: true
  host: 0.0.0.0
  port: 8000
  cors_origins:
    - "*"
  ws_poll_sec: 2.0
  default_limit: 50

storage:
  sqlite_path: artifacts/state/bn_ml.db
  backup:
    enabled: true
    base_dir: artifacts/backups
    interval_minutes: 60
    keep_last: 48
    include_state_db: true
    include_models: true
    include_metrics: true
    include_logs: false
